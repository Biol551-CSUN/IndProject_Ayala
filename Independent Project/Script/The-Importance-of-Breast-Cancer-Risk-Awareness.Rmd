---
title: "The Importance of Breast Cancer Risk Awareness"
author: "Nicole Ayala"
date: "`r Sys.Date()`"
output: 
    prettydoc::html_pretty:
    toc: TRUE
    theme: HPSTR
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE)
```

### The Purpose of This Independent Project

 -I wanted to focus on some factors that correlate to the cause of breast cancer and impact the possibility of the cancer recurring due to said factors. I want to see how these factors associate with each other. 




### Load the Libraries
```{r}
library(tidyverse)
library(here)
library(ggtext)
library(ggplot2)
library(ggrepel)
library(ggridges)
library(hrbrthemes)
library(beyonce)
library(dplyr)
library(tidyr)
library(gganimate)
```


### Read in the Data
```{r}
cancer <- read_csv(here("Independent Project", "Data", "breast-cancer.csv")) # the breast cancer data set
breastcancer <- read_csv(here("Independent Project", "Data","data.csv")) 
#View(breastcancer)
```

### Filter the Data
```{r}
densitycancer <- cancer %>%
  drop_na() %>%
  filter(class == "recurrence-events")

barcancer <- cancer %>%
  drop_na() 

heatcancer <- breastcancer %>%
  drop_na() %>%
  filter(texture_mean > "9.000")
  
  

```



### Using a HeatMap 
```{r The Hex Plot, fig.asp= 1.0, fig.align='center', fig.dim = c(7, 8), fig.cap= "This figure shows the averages of texture sensitivity of the breast from the center point of the core tumor based on their average radii.", dev='pdf', echo=FALSE}

  ggplot(data = breastcancer,aes(
                x = texture_mean,
                y = radius_mean,
                )) +
         geom_hex(stat = "binhex", position = "identity") +
  labs(title = "Correlation of the two Frequencies,\n Average of Radius and Texture within Breast Cancer Patients", subtitle = "There are two groups of breast cancer patients,some with benign tumors and others with malignant tumors.", # title and subtitles x and y axes 
       x="Average Texture",
       y="Average Radius") +
  theme_classic() +
  theme(plot.title = element_text(size = 15, hjust = 0.5, color ="darkseagreen4"), # title size and color
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =10,hjust = 0.5, lineheight = 1.1, color = "darkseagreen"), # subtitle size and color
        axis.title = element_text(size=15,color = "darkorchid4", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 10,color = "darkorchid4",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = "dotted", color = "darkorchid4"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white", fill ="white")) # background color
        
        ggsave(here("Independent Project","Output","hexplot.jpeg"))


```
#### Density Ridges plot
```{r}
ggplot(cancer,aes(
       x = "deg-malig",
       y = "tumor-size" 
       )) +
   geom_density_ridges(rel_min_height = 0.005) +
  labs(title = "The Relationship Between Malignancy Rate and the Size of the Tumor.", # title
       subtitle = "Patients with larger tumors", # subtitle
    x = "Degree of Malignancy",  # x axis
    y = "Tumor Size", # y axis
  ) +
  theme_light()
  
       
        
```
#### Bubble Plot
```{r  The Bubble Plot, fig.asp= 1.0, fig.align='center', fig.cap= "This bubble plot demonstrates how older breast cancer patients (aged 50+) tend to commonly get tumors on the bottom left breast with a malignancy degree of 3.", echo=FALSE}
ggplot(data = subset(cancer,!is.na(`breast-quad`)),
       aes(x = `tumor-size`,
           y = `breast-quad`, 
              size = `deg-malig`,
              frame = age,col = age)) +
  geom_point(shape = 17) +
  geom_label_repel(aes(label = `deg-malig`,
                  box.padding   = 0.35, 
                  point.padding = 0.5,
                  segment.color = 'black')) +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  scale_color_manual(values = c("30-39" = "darkseagreen", "40-49" = "firebrick3", "50-59" = "deepskyblue", "60-69" = "gold2", "70-79"="antiquewhite4")) +
  theme_tinyhand() +
   labs(title = "The Impact Between Tumor Size and Breast Quadrant on Malignancy Severity at Various Ages: A Comprehensive Analysis", # title
       subtitle = "Most common areas in the breast that develop a tumor of a 2-3 Malignancy is the center areola and the lower and upper quadrants of the right side.", # subtitle
    x = "Size of Tumor",  # x axis
    y = "Breast Quadrant",# y axis
    size = "Degree of Malignancy",
    frame = "Age", col = "Age")
ggsave(here("Independent Project","Output","bubbleplot.jpeg"))

  
```



### Making a Functional Plot - *To Be Animated or Not to Be Animated*

  ggplot(data=densitycancer, aes(x = class,
                   y = "inv-nodes",
                   color = "deg-malig"))+
    geom_density_ridges() +
    transition_states( 
    age, # what are we animating by
    transition_length = 2, #The relative length of the transition.
     state_length = 2 # The length of the pause between transitions
   )+
  ease_aes("bounce-in-out")  +
  ggtitle('Ascending of Patient Age')+ # title of  patient age 
    scale_color_brewer(palette = "RdPu") +
    labs(x = "Recurrence Event",  # x axis
         y = "Invasive Auxillary Lymph Nodes", # y axis
         title = "Correlation of the Metastasized  Auxillary Lymph Nodes with an Individual's Reccurrence", # title
         subtitle = "An individual that is back in remission after the cancer recurred is most likely to have a metastasizing cancer with abnormally inflamed auxillary lymphnode.") + # subtitle
  theme(plot.title = element_text(size = 20, hjust = 0.5, color ="pink"),
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =15,hjust = 0.5, lineheight = 1.1, color = "pink"),
        axis.title = element_text(size=15,color = "pink", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "pink",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = FALSE, color = "white"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white"))

  anim_save(here("Independent Project","Output","densityplotgif.gif")) # save animation






```{r The Bar Plot, fig.asp= 1.0, fig.align='center', fig.cap= "This animated figure illustrates the age of patients at the time of their diagnosis who have undergone a specific type of chemo therapy known as irradiation therapy which is more invasive and weakening.", echo=FALSE}
ggplot(data = subset(barcancer, !is.na(age)),# drop all na's that were going to be included into the plot
       aes(x = age, # x axis
           fill = irradiat)) + # base this bar plot off of irradiation rate
  geom_bar(position = "dodge") + # what makes it a bar plot
  labs(title= " Rate of Irradiation Therapy\n Based on the Age of the Patients at the Time of Diagnosis",
       subtitle =" As the patients get older, there is a decrease in the amount of individuals that will not undergo \n an extreme form of chemotherapy known as irradiation therapy. ", # detailed title and subtitle 
       x="Patient's Age", # tru x axis
       y="Underwent Radiation", # irradiation therapy as y axis
       fill = "Irradiation") + # what the plot will be based off of
  theme_minimal() + # the main theme
  transition_states( 
        age, # what are we animating by
        transition_length = 2, #The relative length of the transition.
        state_length = 1) + # The length of the pause between transitions
        ease_aes("bounce-in-out") + # type of animation
  scale_fill_manual(values = beyonce_palette(2)) + # the color palette all blue :)
  theme(plot.title = element_text(size = 16, hjust = 0.5, color ="darkgoldenrod1"), # title size and color
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =10,hjust = 0.5, lineheight = 1.1, color = "darkgoldenrod1"), # subtitle size and color
        axis.title = element_text(size=20,color = "cornflowerblue", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "cornflowerblue",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = "dotted", color = "darkgoldenrod1"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white", fill ="white")) # background color
        
        anim_save(here("Independent Project","Output","barplotgif.gif"))
                   
```

