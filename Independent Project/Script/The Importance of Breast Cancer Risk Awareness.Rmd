---
title: "The Importance of Breast Cancer Risk Awareness"
author: "Nicole Ayala"
date: "`r Sys.Date()`"
output: 
    prettydoc::html_pretty:
    toc: TRUE
    theme: HPSTR
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE)
```

### The Purpose of This Independent Project

Everyone knows someone in their life who has been diagnosed or had passed from having a type of breast cancer. Hence, in this in project I wanted to focus on a couple of factors that correlates to the cause of breast cancer.







### Load the Libraries
```{r}
library(tidyverse)
library(here)
library(ggtext)
library(ggplot2)
library(ggridges)
library(hrbrthemes)
library(RColorBrewer)
library(dplyr)
library(tidyr)
library(gganimate)
```


### Read in the Data
```{r}
cancer <- read_csv(here("Independent Project", "Data", "breast-cancer.csv")) # the breast cancer data set
breastcancer <- read_csv(here("Independent Project", "Data","data.csv")) 
#View(breastcancer)
```

### Filter the Data
```{r}
densitycancer <- cancer %>%
  drop_na() %>%
  filter(class == "recurrence-events")

barcancer <- cancer %>%
  drop_na() %>%
  filter(age >= "50-59")

heatcancer <- breastcancer %>%
  drop_na() %>%
  filter(texture_mean > "9.000")
  
  

```

### Making a Functional Plot - *To Be Animated or Not to Be Animated*
```{r}
densityplot <- function(data = cancer, x, y, animate = TRUE)
  
  ggplot(data, aes(x = {{x}},
                   y = {{y}},
                   color = `deg.malig`))+
    geom_density_ridges2() +
    transition_states( 
    age, # what are we animating by
    transition_length = 2, #The relative length of the transition.
     state_length = 2 # The length of the pause between transitions
   )+
  ease_aes("bounce-in-out")  +
  ggtitle('Ascending of Patient Age')+ # title of  patient age 
    scale_color_brewer(palette = "RdPu") +
    labs(x = "Recurrence Event",  # x axis
         y = "Invasive Auxillary Lymph Nodes", # y axis
         title = "Correlation of the Metastasized  Auxillary Lymph Nodes with an Individual's Reccurrence", # title
         subtitle = "An individual that is back in remission after the cancer recurred is most likely to have a metastasizing cancer with abornmally inflamed auxillary lymphnode.") + # subtitle
  theme(plot.title = element_text(size = 20, hjust = 0.5, color ="pink"),
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =15,hjust = 0.5, lineheight = 1.1, color = "pink"),
        axis.title = element_text(size=15,color = "pink", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "pink",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = FALSE, color = "white"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white"))

  anim_save(here("Independent Project","Output","densityplotgif.gif")) # save animation
```

```{r}
densityplot <- function(data = cancer, x, y ,animate = TRUE) {
  
if(animate==TRUE){
  ggplot(data, 
         aes(x = {{x}},
             y = {{y}},
             color = `deg-malig`))+
    geom_density_ridges2() +
    transition_states( 
    age, # what are we animating by
    transition_length = 2, #The relative length of the transition.
     state_length = 2 # The length of the pause between transitions
   )+
  ease_aes("bounce-in-out")  +
  ggtitle('Ascending of Patient Age')+ # title of  patient age 
    scale_color_brewer(palette = "RdPu") +
    labs(x = "Recurrence Event",  # x axis
         y = "Invasive Auxillary Lymph Nodes", # y axis
         title = "Correlation of the Metastasized  Auxillary Lymph Nodes with an Individual's Reccurrence", # title
         subtitle = "An individual that is back in remission after the cancer recurred is most likely to have a metastasizing cancer with abornmally inflamed auxillary lymphnode.") + # subtitle
    theme(plot.title = element_text(size = 20, hjust = 0.5, color ="pink"),
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =15,hjust = 0.5, lineheight = 1.1, color = "pink"),
        axis.title = element_text(size=15,color = "pink", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "pink",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = FALSE, color = "white"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white"))
}
else{
  ggplot(data, aes(x = {{x}},
                   y = {{y}},
                   color = `deg-malig`))+
    geom_density_ridges2() +
    labs(x = "Recurrence Event",  # x axis
         y = "Invasive Auxillary Lymph Nodes", # y axis
         title = "Correlation of the Metastasized  Auxillary Lymph Nodes with an Individual's Reccurrence", # title
         subtitle = " An individual that is back in remission after the cancer recurred is most likely to have a metastasizing cancer with abornmally inflamed auxillary lymphnode.") + # subtitle
    theme(plot.title = element_text(size = 20, hjust = 0.5, color ="pink"),
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =15,hjust = 0.5, lineheight = 1.1, color = "pink"),
        axis.title = element_text(size=15,color = "pink", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "pink",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = FALSE, color = "white"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white"))
  
}
}
```
### Animated Plot
```{r}
densityplot(x = class, y = `inv-falsedes`)



```
### Stagnant Plot
```{r}
densityplot(x = class, y = `inv-falsedes`, animate = FALSE)
```


```{r}
ggplot(data = densitycancer,aes(y = `inv-falsedes`, x = class, fill = diagnosis)) +
    geom_density_ridges() +
    scale_x_continuous(trans = "log10") +
    labs(x = "Recurrence Event",  # x axis
         y = "Invasive Auxillary Lymph Nodes", # y axis
         title = "Correlation of the Metastasized  Auxillary Lymph Nodes with an Individual's Reccurrence", # title
         subtitle = "An individual that is back in remission after the cancer recurred is most likely to have a metastasizing cancer with abornmally inflamed auxillary lymphnode.") + # subtitle
    theme(plot.title = element_text(size = 20, hjust = 0.5, color ="pink"),
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =15,hjust = 0.5, lineheight = 1.1, color = "pink"),
        axis.title = element_text(size=15,color = "pink", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "pink",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = FALSE, color = "white"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white"))
 anim_save(here("Independent Project","Output","densityplot.gif")) # save animation
```
```{r}
barplot <- barcancer %>%
  ggplot(data = barcancer, 
         x = age, 
         y = `tumor.size`,
         fill = `deg.malig`) +
         geom_bar(stat = "identity") +
  labs(title= "",
       subtitle =" ", 
       x="Age",
       y="Tumor Size", 
       fill = "Degree of Malignancy") +
  theme_minimal()
                   
```

### HeatMap 
```{r}

  ggplot(data = breastcancer,aes(x = texture_mean,
             y = radius_mean)) +
         geom_hex(stat = "binhex", position = "identity") +
  labs(title= "",
       subtitle =" ", 
       x="Average Texture",
       y="Average Radius") +
  theme_minimal()


```
```{r}
ggplot(data = cancer, aes(x= class,
                          y = inv-falsedes,
                          fill = color)) + 
  geom_density_ridges(alpha = 0.5,
                      stat = "binline",
                      color = "white",
                      size = 0.2) + 
  theme_minimal() +
  labs(x = "Average Texture", y = "Average Radius", title = "Correlation of the two Frequencies, Average of Radius and Mean within Breast Cancer Patients", subtitle = "There are two group of breast cancer patients some with benign tumors and the other with malignant tumors.") + # title and subtitles + x and y axes 
  theme(
    plot.background = element_rect(fill = "grey98", color = "grey98"),
    plot.title.position = "plot",
    plot.title = element_text(family = "Larrikin", hjust = 0.5, color = "#E58601"),
    plot.caption.position = "plot",
    plot.caption = element_markdown(hjust = 0.5, margin = margin(t = 20), size = rel(0.7), color = "grey60"),
    panel.grid.minor = element_blank(),
    legend.position = "none",
    axis.title = element_blank(),
    axis.text.y = element_markdown(vjust = -4, face = "bold"),
    axis.text.x = element_text(size = rel(0.8)),
    panel.spacing.x = unit(10, "mm"),
    strip.text = element_text(face = "bold", color = "grey60")
  )


```


