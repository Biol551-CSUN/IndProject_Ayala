---
title: "The Importance of Breast Cancer Risk Awareness"
author: "Nicole Ayala"
date: "`r Sys.Date()`"
output: 
    prettydoc::html_pretty:
    toc: TRUE
    theme: HPSTR
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE)
```

### The Purpose of This Independent Project

 -I wanted to focus on some factors that correlate to the cause of breast cancer and impact the possibility of the cancer recurring due to said factors. I want to see how these factors associate with each other. 




### Load the Libraries
```{r}
library(tidyverse)
library(here)
library(ggtext)
library(ggplot2)
library(ggridges)
library(hrbrthemes)
library(beyonce)
library(dplyr)
library(tidyr)
library(gganimate)
```


### Read in the Data
```{r}
cancer <- read_csv(here("Independent Project", "Data", "breast-cancer.csv")) # the breast cancer data set
breastcancer <- read_csv(here("Independent Project", "Data","data.csv")) 
#View(breastcancer)
```

### Filter the Data
```{r}
densitycancer <- cancer %>%
  drop_na() %>%
  filter(class == "recurrence-events")

barcancer <- cancer %>%
  drop_na() 

heatcancer <- breastcancer %>%
  drop_na() %>%
  filter(texture_mean > "9.000")
  
  

```



### Using a HeatMap 
```{r The Hex Plot, fig.asp= 1.0, fig.align='center', fig.width=20, fig.height=7, fig.cap= "This figure shows the averages of texture sensitivity of the breast from the center point of the core tumor based on their average radii.", dev='pdf', echo=FALSE}

  ggplot(data = breastcancer,aes(
                x = texture_mean,
                y = radius_mean,
                )) +
         geom_hex(stat = "binhex", position = "identity") +
  labs(title = "Correlation of the two Frequencies,\n Average of Radius and Texture within Breast Cancer Patients", subtitle = "There are two groups of breast cancer patients,some with benign tumors and others with malignant tumors.", # title and subtitles x and y axes 
       x="Average Texture",
       y="Average Radius") +
  theme_classic() +
  theme(plot.title = element_text(size = 15, hjust = 0.5, color ="darkseagreen4"), # title size and color
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =10,hjust = 0.5, lineheight = 1.1, color = "darkseagreen"), # subtitle size and color
        axis.title = element_text(size=15,color = "darkorchid4", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 10,color = "darkorchid4",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = "dotted", color = "darkorchid4"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white", fill ="white")) # background color
        
        ggsave(here("Independent Project","Output","hexplot.jpeg"))


```


### Making a Functional Plot - *To Be Animated or Not to Be Animated*

  ggplot(data=densitycancer, aes(x = class,
                   y = "inv-nodes",
                   color = "deg-malig"))+
    geom_density_ridges() +
    transition_states( 
    age, # what are we animating by
    transition_length = 2, #The relative length of the transition.
     state_length = 2 # The length of the pause between transitions
   )+
  ease_aes("bounce-in-out")  +
  ggtitle('Ascending of Patient Age')+ # title of  patient age 
    scale_color_brewer(palette = "RdPu") +
    labs(x = "Recurrence Event",  # x axis
         y = "Invasive Auxillary Lymph Nodes", # y axis
         title = "Correlation of the Metastasized  Auxillary Lymph Nodes with an Individual's Reccurrence", # title
         subtitle = "An individual that is back in remission after the cancer recurred is most likely to have a metastasizing cancer with abnormally inflamed auxillary lymphnode.") + # subtitle
  theme(plot.title = element_text(size = 20, hjust = 0.5, color ="pink"),
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =15,hjust = 0.5, lineheight = 1.1, color = "pink"),
        axis.title = element_text(size=15,color = "pink", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "pink",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = FALSE, color = "white"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white"))

  anim_save(here("Independent Project","Output","densityplotgif.gif")) # save animation



densityplot <- function(data = densitycancer, x, y ,animate = TRUE) {
  
if(animate==TRUE){
  ggplot(data, 
         aes(x = {{x}},
             y = {{y}},
             color = "deg-malig"))+
    geom_density_ridges2() +
    transition_states( 
    age, # what are we animating by
    transition_length = 2, #The relative length of the transition.
     state_length = 2 # The length of the pause between transitions
   )+
  ease_aes("bounce-in-out")  +
  ggtitle('Ascending of Patient Age')+ # title of  patient age 
    scale_color_brewer(palette = "RdPu") +
    labs(x = "Recurrence Event",  # x axis
         y = "Invasive Auxillary Lymph Nodes", # y axis
         title = "Correlation of the Metastasized  Auxillary Lymph Nodes with an Individual's Reccurrence", # title
         subtitle = "An individual that is back in remission after the cancer recurred is most likely to have a metastasizing cancer with abornmally inflamed auxillary lymphnode.") + # subtitle
    theme(plot.title = element_text(size = 20, hjust = 0.5, color ="pink"),
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =15,hjust = 0.5, lineheight = 1.1, color = "pink"),
        axis.title = element_text(size=15,color = "pink", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "pink",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = FALSE, color = "white"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white"))
}
else{
  ggplot(data, aes(x = {{x}},
                   y = {{y}},
                   color = "deg-malig"))+
    geom_density_ridges2() +
    labs(x = "Recurrence Event",  # x axis
         y = "Invasive Auxillary Lymph Nodes", # y axis
         title = "Correlation of the Metastasized  Auxillary Lymph Nodes with an Individual's Reccurrence", # title
         subtitle = " An individual that is back in remission after the cancer recurred is most likely to have a metastasizing cancer with abornmally inflamed auxillary lymphnode.") + # subtitle
    theme(plot.title = element_text(size = 20, hjust = 0.5, color ="pink"),
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =15,hjust = 0.5, lineheight = 1.1, color = "pink"),
        axis.title = element_text(size=15,color = "pink", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "pink",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = FALSE, color = "white"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white"))
  
}
}

cancer %>%
ggplot(aes(x = "deg-malig", 
           y = "breast-quad", 
           fill = stat(quantile))) +
  stat_density_ridges(quantile_lines = TRUE,
                      calc_ecdf = TRUE,
                      geom = "density_ridges_gradient", 
                      quantiles = c(0.05, 0.95)) +
  scale_fill_manual(name = "Prob.", values = c("#E2FFF2", "white", "#B0E0E6"),
                    labels = c("(0, 5%]", "(5%, 95%]", "(95%, 1]")) +
 transition_states( 
     year, # what are we animating by
     transition_length = 2, #The relative length of the transition.
     state_length = 1 # The length of the pause between transitions
   )+
  ease_aes("bounce-in-out")  +
  ggtitle('Age of the Patient at the Time of Diagnosis')+ # title of year changes
  anim_save(here("Independent Project","densitygif.gif")) # save

### Animated Plot

densityplot(x = class, y = "inv-falsedes")



### Stagnant Plot

densityplot(x = class, y = `inv-falsedes`, animate = FALSE)



--------------
ggplot(data = densitycancer,aes(y = `inv-falsedes`, x = class, fill = diagnosis)) +
    geom_density_ridges() +
    scale_x_continuous(trans = "log10") +
    labs(x = "Recurrence Event",  # x axis
         y = "Invasive Auxillary Lymph Nodes", # y axis
         title = "Correlation of the Metastasized  Auxillary Lymph Nodes with an Individual's Reccurrence", # title
         subtitle = "An individual that is back in remission after the cancer recurred is most likely to have a metastasizing cancer with abornmally inflamed auxillary lymphnode.") + # subtitle
    theme(plot.title = element_text(size = 20, hjust = 0.5, color ="pink"),
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =15,hjust = 0.5, lineheight = 1.1, color = "pink"),
        axis.title = element_text(size=15,color = "pink", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "pink",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = FALSE, color = "white"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white"))
 anim_save(here("Independent Project","Output","densityplot.gif")) # save animation

```{r The Bar Plot, fig.asp= 1.0, fig.align='center', fig.cap= "This animated figure illustrates the age of patients at the time of their diagnosis who have undergone a specific type of chemo therapy known as irradiation therapy which is more invasive and weakening.", echo=FALSE}
ggplot(data = subset(barcancer, !is.na(age)),# drop all na's that were going to be included into the plot
       aes(x = age, # x axis
           fill = irradiat)) + # base this bar plot off of irradiation rate
  geom_bar(position = "dodge") + # what makes it a bar plot
  labs(title= " Rate of Irradiation Therapy\n Based on the Age of the Patients at the Time of Diagnosis",
       subtitle =" As the patients get older, there is a decrease in the amount of individuals that will not undergo \n an extreme form of chemotherapy known as irradiation therapy. ", # detailed title and subtitle 
       x="Patient's Age", # tru x axis
       y="Underwent Radiation", # irradiation therapy as y axis
       fill = "Irradiation") + # what the plot will be based off of
  theme_minimal() + # the main theme
  transition_states( 
        age, # what are we animating by
        transition_length = 2, #The relative length of the transition.
        state_length = 1) + # The length of the pause between transitions
        ease_aes("bounce-in-out") + # type of animation
  scale_fill_manual(values = beyonce_palette(2)) + # the color palette all blue :)
  theme(plot.title = element_text(size = 16, hjust = 0.5, color ="darkgoldenrod1"), # title size and color
        plot.title.position = "plot", # title adjustments
        plot.subtitle = element_text(size =10,hjust = 0.5, lineheight = 1.1, color = "darkgoldenrod1"), # subtitle size and color
        axis.title = element_text(size=20,color = "cornflowerblue", hjust = 0.5), # title adjustments
        axis.text = element_text(size = 15,color = "cornflowerblue",hjust = 0.5), # text adjustments
        panel.grid = element_line(linewidth = 0.35, linetype = "dotted", color = "darkgoldenrod1"), # background gridlines
        plot.margin = unit(c(1.0, 1.0, 1.0, 1.0), "cm"), # margin adjustments
        plot.background = element_rect(color = "white", fill ="white")) # background color
        
        anim_save(here("Independent Project","Output","barplotgif.gif"))
                   
```
